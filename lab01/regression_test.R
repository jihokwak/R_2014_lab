## 회귀분석 이해
x=1:100
y=2*x+30
cor(x,y)
d=cbind(x,y)
plot(d)
lm(y~x)


## 실제 데이터 적용 
# ft=아버지 키
# st=아들 키
ft=c(156,159,168,177,183,183,192)
st=c(166,166,169,175,183,186,187)
cor(ft,st)
d=cbind(ft,st,rep(1,length(ft)))
plot(d)
m=lm(st~ft)
m

## 이하 검증
tft=seq(156,192)       #seq(min(ft),max(ft))
tst=0.667*tft+60
td=cbind(tft,tst,rep(2,length(tft)))
td
ret=rbind(d,td)
plot(ret,pch = 21,bg = c("red", "green3")[ret[,3]])

# predict를 통한 검증 (위와 같음. 단지 수식을 만들지 않아도 되는 장점이 있을 뿐임.)
predict(m,newdata=data.frame(ft=155))
ptft=seq(156,192)
ptst=predict(m,newdata=data.frame(ft=seq(156,192)))
ptd=cbind(ptft,ptst,rep(2,length(tft)))
pret=rbind(d,ptd)
plot(pret,pch = 21,bg = c("red", "green3")[pret[,3]])

summary(m)
